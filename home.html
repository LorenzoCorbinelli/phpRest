<!DOCTYPE html>
<html>
	<head>
		<title>Home</title>
	</head>
	<body onload="setup()">
		<script>
			var xhr;
			function setup()
			{
				xhr = new XMLHttpRequest();
				//configuro la callback per la risposta
				xhr.onload = function() {
					document.getElementById('risposta').innerHTML = xhr.response;
				};
				//configuro la callback di errore
				xhr.onerror = function() { 
					alert('Errore');
				};
			}
			function scelta_metodo()
			{
				switch(document.getElementById('metodo').value)
				{
					case "get":
						document.getElementById('get').hidden=false;
						document.getElementById('post').hidden=true;
						document.getElementById('delete').hidden=true;
						document.getElementById('risposta').innerHTML='';
					break;
					case "post":
						document.getElementById('post').hidden=false;
						document.getElementById('get').hidden=true;
						document.getElementById('delete').hidden=true;
						document.getElementById('risposta').innerHTML='';
					break;
					case "delete":
						document.getElementById('delete').hidden=false;
						document.getElementById('get').hidden=true;
						document.getElementById('post').hidden=true;
						document.getElementById('risposta').innerHTML='';
					break;
					default:
						document.getElementById('delete').hidden=true;
						document.getElementById('get').hidden=true;
						document.getElementById('post').hidden=true;
						document.getElementById('risposta').innerHTML='';
					break;
				}
			}
			function radio_get()
			{
				if(document.getElementById('radio_id').checked)
					document.getElementById('id_get').hidden=false;
				else
					document.getElementById('id_get').hidden=true;
			}
			function selezione_tabella()
			{
				if(document.getElementById('tabella_post').value=='student')
				{
					document.getElementById('post_student').hidden=false;
					document.getElementById('post_class').hidden=true;
					document.getElementById('post_studentClass').hidden=true;
				}
				else //if(document.getElementById('tabella_post').value=='class') 
				{
					document.getElementById('post_student').hidden=true;
					document.getElementById('post_class').hidden=false;
					document.getElementById('post_studentClass').hidden=true;
				}
				/*else
				{
					document.getElementById('post_student').hidden=true;
					document.getElementById('post_class').hidden=true;
					document.getElementById('post_studentClass').hidden=false;
				} */
			}
			function get()
			{	
				//con ID
				if((document.getElementById('id_get').value!="")&&!document.getElementById('tutto_get').checked)
				{
					if(document.getElementById('tabella').value=='class')
					{
						xhr.open("GET", ('classes.php/'+document.getElementById('id_get').value), true);
					}
					else
					{
						xhr.open("GET", ('students.php/'+document.getElementById('id_get').value), true);
					}
				//senza ID (tutti i record)
				}else
				{
					if(document.getElementById('tabella').value=='class')
					{
						xhr.open("GET", 'classes.php', true);
					}
					else
					{
						xhr.open("GET", 'students.php', true);
					}
				}
				xhr.send();
			}
			function post()
			{
				if(document.getElementById('tabella_post').value=='student')
				{
					xhr.open("POST", 'students.php', true);
					var json = '{"name":"' + document.getElementById('post_name').value + '", "surname":"' + document.getElementById('post_surname').value + '", "sidiCode":"' + document.getElementById('post_sidiCode').value + '", "taxCode":"' + document.getElementById('post_taxCode').value +'"}';
				}
				else
				{
					xhr.open("POST", 'classes.php' ,true);
					var json = '{"year":"' + document.getElementById('post_year').value + '", "section":"' + document.getElementById('post_section').value + '"}';
				}
				xhr.setRequestHeader("Content-type", "application/json");
				xhr.send(json); 
			}
			function Delete()
			{
				if(document.getElementById('tabella_delete').value=='student')
				{
					xhr.open("DELETE", 'students.php/'+document.getElementById('id_delete').value, true);
				}
				else
				{
					xhr.open("DELETE", 'classes.php/'+document.getElementById('id_delete').value, true);
				}
				xhr.send();
			}
		</script>
		<div>
			<select id="metodo" onchange="scelta_metodo()">
				<option value="default">Seleziona il metodo</option>
				<option value="get">GET</option>
				<option value="post">POST</option>
				<option value="delete">DELETE</option>
			</select>
			<div id="get" hidden=true>
				Seleziona la tabella: 
				<select id="tabella"> 
					<option value="student">Student</option> 
					<option value="class">Class</option> 
				</select> 
				<input id="tutto_get" type="radio" name="get" value="tutto" onchange="radio_get()">Tutto <input id="radio_id" type="radio" name="get" value="ID" onchange="radio_get()">
				Con ID <input type="text" id="id_get" hidden=true> 
				<input type="button" onclick="get()" value="Invia">
			</div>
			<div id="post" hidden=true>
				Seleziona la tabella: 
				<select id="tabella_post" onchange="selezione_tabella()"> 
					<option value="student">Student</option> 
					<option value="class">Class</option> 
					<option value="student_class">Student_class</option> 
				</select> 
				<div id="post_student">
					Name: <input type="text" id="post_name"><br> 
					Surname: <input type="text" id="post_surname"><br> 
					SidiCode: <input type="text" id="post_sidiCode"><br> 
					TaxCode: <input type="text" id="post_taxCode"><br> 
				</div>
				<div id="post_class" hidden=true>
					Year: <input type="text" id="post_year"><br>
					Section: <input type="text" id="post_section"><br>
				</div>
			<!--	<div id="post_studentClass" hidden=true>
					idStudent: <input type="text" id="post_idStudent"><br> 
					idClass: <input type="text" id="post_idClass"><br> 
				</div> -->
				<input id="invia" type="button" value="Invia" onclick="post()">
			</div>
			<div id="delete" hidden=true>
				Seleziona la tabella: 
				<select id="tabella_delete"> 
					<option value="student">Student</option> 
					<option value="class">Class</option> 
				</select>
				<input type="text" id="id_delete"> 
				<input type="button" onclick="Delete()" value="Invia">
			</div>
		</div>
		<p>Risposta:</p>
		<div id="risposta"></div>
	</body>
</html>